---
import {cn} from '../../../../common/utils'
const { placeholder, className } = Astro.props as { placeholder: string, className: string };
---
<input
  id="searchInput"
  placeholder={placeholder}
  class={cn(
      'flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50',
      className
    )}
>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const searchInput = document.getElementById('searchInput');

  function setInputValueFromURL() {
    const searchParams = new URLSearchParams(window.location.search);
    const searchValue = searchParams.get('search');
    if (searchValue) {
      searchInput.value = searchValue;
    }
  }
  setInputValueFromURL();
  
  searchInput?.addEventListener('blur', function(event) {
    const searchValue = event.target ? event.target.value : '';
    const searchParams = new URLSearchParams();
    if (searchValue) {
      searchParams.set('search', searchValue);
    } else {
      searchParams.delete('search');
    }
    window.history.pushState(null, '', `?${searchParams}`);
  });
});
</script>